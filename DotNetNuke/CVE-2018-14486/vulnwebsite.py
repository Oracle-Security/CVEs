from flask import Flask, request, jsonify
import requests

app = Flask(__name__)

@app.route('/')
def index():
    return '''
    <!DOCTYPE html>
    <html>
    <head>
        <title>Intentionally Vulnerable SSRF Site</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    </head>
    <body>
        <div class="container mt-5">
            <h1 class="mb-4">Intentionally Vulnerable SSRF Website Dev'd by Oracle-Security</h1>
            <div class="alert alert-info" role="alert">
                Check out my <a href="https://github.com/Oracle-Security">GitHub profile</a> for more of my projects.
            </div>
            <div class="form-group">
                <label for="url">URL:</label>
                <input type="text" class="form-control" id="url" placeholder="Enter URL">
            </div>
            <button type="button" class="btn btn-primary" id="submit">Submit</button>
            <div class="mt-4" id="response"></div>
        </div>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script>
            $(document).ready(function() {
                $('#submit').click(function() {
                    var url = $('#url').val();
                    $.ajax({
                        url: '/curl?url=' + encodeURIComponent(url),
                        success: function(response) {
                            $('#response').html(response);
                        }
                    });
                });
            });
        </script>
    </body>
    </html>
    '''

@app.route('/curl')
def curl():
    url = request.args.get('url')
    response = requests.get(url)
    return jsonify(response.text)

if __name__ == '__main__':
    app.run(port=8001, debug=True, threaded=True)