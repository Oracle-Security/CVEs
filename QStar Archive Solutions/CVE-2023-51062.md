## CVE-2023-51062

### Description
An unauthenticated log file read in the component log-smblog-save of Star Archive Solutions RELEASE_3-0 Build 7 Patch 0 allows attackers to disclose the SMB Log contents via executing a crafted command.

### Vulnerability Type
Incorrect Access Control

### Vendor of Product
QStar

### Affected Product Code Base
QStar Archive Solutions - Release RELEASE_3-0 Build 7 Patch 0

### Exploitation
To exploit this vulnerability, the attacker must execute a specific command (Within the parameter) to obtain the SMB log file.

### PoC 

> Vulnerable Code - ./main.php
```php
function smblog_save()
{
	$logType = $_GET['l'];
	if ($logType == "nmb")
		$url = "/usr/var/log.nmbd";
	else if ($logType == "smb")
		$url = "/usr/var/log.smbd";
	else if ($logType == "winbindd")
		$url = "/usr/var/log.winbindd";
	else
		return;

	header('Content-Description: File Transfer');
	header('Content-Type: application/octet-stream');
	header('Content-Disposition: attachment; filename="' . basename($url) . '";');
	header('Content-Length: ' . filesize($url));

	@readfile($url) OR die();
	?>
	<script>window.close();</script>
	<?
}
```

In the above code, no authentication is required. Simply visiting `/log-smblog-save?l=nmb` will allow you to read the logs.